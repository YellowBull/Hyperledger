# Hyperledger Fabric Model -- 超级账本组成模型
细述如何实现一个全面的、可定制的企业级区块链解决方案。<br/>
## 资产定义
--资产这里理解为任何具有货币价值的东西，他们可以通过网络进行交易，无论是超市的商品到古董车再到货币期货都属于资产。<br/>
## 智能合约
--链码（Chaincode）即Fabric的智能合约，分为系统链码和用户链码。链码的执行有事务排序划分，限制了节点类型间的信任和验证
级别，并优化了网络的可伸缩性和性能。<br/>
## 账本特征
--账本不可变的、共享的并且每个通道（channel）编码了整个事务历史，还包含了类似sql的查询功能，用于高效的审计和解决争议。<br/>
## 隐私通道
--多通道（channel）交易的设计方案可以确保竞争的企业和受监管的行业在一个公共网络删交换资产时的高度隐私及保密性。<br/>
## 成员安全
--Hyperledger Fabric只允许被授权加盟的成员参与数据维护，并且成员间相互认可所有的交易都会被彼此发现和跟踪。这种方式提供了一个可
信的区块链网络。<br/>
## 共识机制
--共识策略的设定是 为了达成一致的一种独特的方法，他可以实现企业间所需的灵活性和可伸缩性。<br/>
## 资产
资产可以从有形资产（如房地产和硬件）到无形资产（如合同合同知识产权）。Hyperledger Fabric提供了使用智能合约交易修改资产的能力。
资产在Hyperledger Fabric中以键值对集合的形态存在，在通道（channel）中各本地账本可以对其状态提交变更事务。资产可以用二进制或JSON
形式表示。我们可以通过HyperledgerFabric的Composer工具很容易的定义和使用Hyperledger Fabric应用程序中的资产。<br/>
## 智能合约
智能合约是定义资产并且可以用于修改资产的事务指令的软件。换句话说，他就是一个（channel）所有的业务逻辑。智能合约指定了执行读取或
修改键值对以及其他状态数据库信息操作的规则。智能合约通过一个事务请求来执行对账本的当前状态数据库操作。智能合约执行会生成一组读写集
，这组读写集可以通过网络提交给排序服务节点，并用排序服务节点广播且应用到所有的对等节点上。<br/>
## 账本特征
在Fabric中产生的所有针对数据状态变更的请求都会生成有序且不可篡改的记录存于账本中。数据状态的变更是由所有参与方认可的智能合约调用的
事务的结果。每个事务都将产生一组资产键值对，这些键值对作为创建、更新或删除等操作而同步到所有账本。<br/>
账本由区块链（区块链根据hash等算法组成的链条）组成，而每一个区块链中都存储有一条或一组有序的且不可篡改的记录，也就是一个状态数据库
来维护当前的Fabric的状态。每个通道（channel）都用且仅有一个账本，在该通道（channel）中的每个加盟成员的对等点都维护同一份账本。<br/>
* 通过使用基键（键查询）、范围查询及组合键查询等方式可对账本执行查询和更新操作。
* 使用富查询语言的只读查询（如果使用CouchDB作为状态数据库）。
* 只读历史查询--通过一个键来查询账本历史记录，支持数据来源场景。
* 每一条请求结果都通过智能合约读取的读集和智能合约写入的写集的键值得多版本组合。
* 同一个通道（channel）中的区块里的所有请求事务都会被排序，并且这些区块会被排序服务节点广播到该通道（channel）内的所有对等节点。
* 对等节点对请求事务的验证依靠背书策略并严格执行该策略。
* 在添加一个块之前，执行了版本控制检查，以确保被读取的资产的状态在链代码执行时间之后没有改变。
* 即将执行变更的请求事务集在新增到一个区块之前必须要做一次版本验证，以确保被读取的资产状态集在本条智能合约执行时间之前没有改变过。
* 一但请求事务被验证提交，就不可篡改。
* 一个通道（channel）的账本包含一个区块生成的配置策略、访问控制列表和其他相关信息。
* 考虑到通道（channel）将会从不同的证书机构得到加密文件，因此通道（channel）中拥有成员提供者（MSP）实例
## 隐私通道
Hyperledger Fabric在每个通道（channel）中都有一个不可篡改的账本，以及一个可以操纵和修改的当前资产状态的自能合约（例如
更新键值对）。一个账本限制在一个通道（channel）的范围内--他可以在整个网络中共享（假设每个参与者都在一个公共通道（channel）
上运行）--或者他也可以被私有化，只包含一个组特定的参与者。<br/>
在上述中的后一种情况下，这些参与者将创建一个单独的通道（channel），从而使他们的事务和账本隔离看出来。为了满足即公开透明
又能保护隐私的场景，智能合约只能在需要访问资产状态来执行读和写操作的对等节点上安装（换句话说，如果一个智能合约没有安装在
对等节点上，他将无法调用账本透露出去的接口）。<br/>
为了进一步混淆数据，智能合约中的简直可以使用诸如AES之类的通用加密算法进行加密（在一定程度上或全部使用），然后将事务发送到
排序服务，并将生成的区块追加到账本上，一但加密的数据被写入账本，他只能被拥有相应的钥匙用户解密。<br/>
## 成员安全
Hyperledger Fabric是一个支持所有参与者都有自己的身份的交易网络。公钥的底层方案用于生成与组织、网络组件和最终用户或客户端
应用程序绑定的加密证书。因此，可以在更广泛的网络和通道（channel）层次上对数据访问控制进行操作和治理。隐私和保密是最重要和最
关键的问题，Hyperledger Fabric这种“被许可”的概念，在加上通道（channel）的存在和功能，有助于解决该问题。<br/>
## 共识机制
在分布式账本技术中，共识作为单一功能最近成为了一种特定算法的同义词。然而，共识不仅仅是简单的就事务的顺序达成一致，而且在Hyperledger
 Fabric中这种通过他在整个事务流中的基本作用，包括从提交请求，背书验证，到事务排序，确认和广播，这种区别尤为突出。简单的说，
共识被定义为一个完整的循环，他是由一个经过验证合适的区块所包含的一组事务。<br/>
当一个区块中的事务集合的顺序和结果经过所有的检查而符合策略标准时，将最终达成一致。这些检查和平衡发生在一个个请求事务的生命周期中
，包括使用背书策略来规定哪些特定的成员必须支持某个事务类，以及系统智能合约，以确保这些策略得到执行和维护。在提交排序服务节点
之前，这些执行验证的对等节点将使用这些系统智能合约来确保足够的背书支持，并从适当的实体中获得。此外，在任何包含事务的区块被添加
进账本之前，将进行版本控制，在此期间，将对账本的当前状态进行商定或同意，最后的检查提供了对双重开销操作（处理相同事务）和其他可能
危害数据完整性的威胁的保护，并允许被执行的方法依赖非静态变量。<br/>
除了大量的背书认可，有效性和版本控制检查之外，在事务流的各个方向上也有正在进行的身份验证。访问控制列表是在通过网络实现的（
排序服务下发到所有通道），并且因为一条事务请求将会通过不同的体系结构组件，所以payloads会被反复的签名，复核及验证。总之，达成
共识并不仅仅局限于一组交易的达成一致，而是一种包罗万象的特性，他是在交易从提案到最终广播过程中进行的持续验证的副产品。
